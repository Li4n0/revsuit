(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f1802c3c"],{"5fa3":function(e,t,a){},"9520c":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-button",{attrs:{id:"add-rule",type:"primary"},on:{click:e.addRule}},[a("a-icon",{attrs:{type:"plus"}}),e._v(" New Rule ")],1),a("a-drawer",{attrs:{title:e.formAction+" HTTP rule",width:490,visible:e.formVisible,"body-style":{paddingBottom:"80px"}},on:{close:e.closeDrawer}},[a("a-form-model",{ref:"form",attrs:{model:e.form,layout:"vertical"},on:{submit:e.handleSubmit}},[a("BasicRule",{attrs:{form:e.form,readOnly:e.formReadOnly,flagFormat:"raw message"}}),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{rules:e.rules.response_status_code,prop:"response_status_code"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" Response Status Code "),a("a-tooltip",{attrs:{title:"Number between 100-600, or template such as ${query.varname}/${body.varname}/${header.varname}/${flag}/${custom_varname}"}},[a("a-icon",{attrs:{type:"question-circle-o"}})],1)],1),a("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"200",disabled:e.formReadOnly},model:{value:e.form.response_status_code,callback:function(t){e.$set(e.form,"response_status_code",t)},expression:"form.response_status_code"}})],1)],1)],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:24}},[a("a-form-model-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" Response Headers "),a("a-tooltip",{attrs:{title:"Support template such as ${query.varname}/${body.varname}/${header.varname}"}},[a("a-icon",{attrs:{type:"question-circle-o"}})],1)],1),e._l(e.headerKeys,(function(t){return a("a-input-group",{key:t,attrs:{compact:""}},[a("a-auto-complete",{directives:[{name:"decorator",rawName:"v-decorator",value:["Header-"+t],expression:"['Header-'+headerKey,]"}],staticStyle:{width:"47%","margin-bottom":"5px"},attrs:{dataSource:e.headerSet,filterOption:e.filterOption,defaultOpen:!1,placeholder:"Header",disabled:e.formReadOnly},model:{value:e.form["Header-"+t],callback:function(a){e.$set(e.form,"Header-"+t,a)},expression:"form['Header-'+headerKey]"}}),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Value-"+t],expression:"['Value-'+headerKey,]"}],staticStyle:{width:"53%"},attrs:{placeholder:"Value",disabled:e.formReadOnly},on:{focus:function(){!e.formReadOnly&&t===e.headerKeys[e.headerKeys.length-1]&&e.form["Header-"+t]&&e.addHeader()}},model:{value:e.form["Value-"+t],callback:function(a){e.$set(e.form,"Value-"+t,a)},expression:"form['Value-'+headerKey]"}},[a("a-icon",{staticClass:"dynamic-delete-button",attrs:{slot:"addonAfter",type:"minus-circle-o"},on:{click:function(){return e.formReadOnly?null:e.removeHeader(t)}},slot:"addonAfter"})],1)],1)}))],2)],1)],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:24}},[a("a-form-model-item",[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" Response Body "),a("a-tooltip",{attrs:{title:"Support template such as ${query.varname}/${body.varname}/${header.varname}"}},[a("a-icon",{attrs:{type:"question-circle-o"}})],1)],1),a("a-icon",{staticClass:"full-screen-icon",attrs:{type:"fullscreen"},on:{click:function(t){e.fullScreenTextarea=!0}}}),a("a-textarea",{attrs:{placeholder:"Hello RevSuit!",readOnly:e.formReadOnly,"auto-size":{minRows:10,maxRows:30}},model:{value:e.form.response_body,callback:function(t){e.$set(e.form,"response_body",t)},expression:"form.response_body"}}),a("a-modal",{attrs:{"dialog-style":{top:"40px",bottom:"20px"},width:"80rem",visible:e.fullScreenTextarea,title:"Response Body",okText:""},on:{ok:function(t){e.fullScreenTextarea=!1},cancel:function(t){e.fullScreenTextarea=!1}}},[a("a-textarea",{staticStyle:{height:"100%"},attrs:{placeholder:"Hello RevSuit!",readOnly:e.formReadOnly,"auto-size":{minRows:e.fullScreenTextareaMinRows(),maxRows:1.5*e.fullScreenTextareaMinRows()}},model:{value:e.form.response_body,callback:function(t){e.$set(e.form,"response_body",t)},expression:"form.response_body"}})],1)],1)],1)],1)],1),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:e.handleCancel}},[e._v(" Cancel ")]),a("a-button",{attrs:{type:"primary",disabled:e.formReadOnly},on:{click:e.handleSubmit}},[e._v(" Submit ")])],1)],1),a("a-table",{staticStyle:{"overflow-x":"auto"},attrs:{columns:e.columns,"data-source":e.data,loading:e.loading,pagination:e.pagination},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"filterDropdown",fn:function(t){var o=t.setSelectedKeys,r=t.selectedKeys,n=(t.clearFilters,t.column);return a("div",{staticStyle:{padding:"8px"}},[a("a-input",{staticStyle:{width:"188px","margin-bottom":"8px",display:"block"},attrs:{placeholder:"Search "+n.dataIndex,value:r[0]},on:{change:function(e){return o(e.target.value?[e.target.value]:[])},pressEnter:function(){e.filters[n.dataIndex]=r[0],e.fetch()}}}),a("a-button",{staticStyle:{width:"90px","margin-right":"8px"},attrs:{type:"primary",icon:"search",size:"small"},on:{click:function(){e.filters[n.dataIndex]=r[0],e.fetch()}}},[e._v(" Search ")])],1)}},{key:"filterIcon",fn:function(e){return a("a-icon",{style:{color:e?"#108ee9":void 0},attrs:{type:"search"}})}},{key:"rank",fn:function(t){return a("span",{},[a("a-tag",{attrs:{color:"#"+(2996213+80*t).toString(16)}},[e._v(" "+e._s(t)+" ")])],1)}},{key:"switchRender",fn:function(t,o,r,n){return a("span",{},[a("a-switch",{attrs:{checked:t},on:{click:function(t){return e.clickSwitch(o,n.dataIndex)}}})],1)}},{key:"action",fn:function(t,o,r){return a("span",{},[a("a-button",{staticStyle:{color:"#67C23A","background-color":"transparent","border-color":"#67C23A","text-shadow":"none",margin:"0 10px 3px 0"},attrs:{size:"small",ghost:""},on:{click:function(t){return e.viewRule(o)}}},[e._v("View")]),a("a-button",{staticStyle:{color:"#909399","background-color":"transparent","border-color":"#909399","text-shadow":"none",margin:"0 10px 3px 0"},attrs:{size:"small",ghost:""},on:{click:function(t){return e.editRule(o,r)}}},[e._v("Edit")]),a("a-popconfirm",{attrs:{title:"Are you sure delete this task?","ok-text":"Yes","cancel-text":"No"},on:{confirm:function(t){return e.deleteRule(o,r)}}},[a("a-button",{attrs:{type:"danger",size:"small",ghost:""}},[e._v("Delete")])],1)],1)}}])})],1)},r=[],n=a("5530"),s=(a("a434"),a("fb6a"),a("34c6")),i=a("56d7"),l=a("2084"),c="View",d="Edit",u="Create",f=[{title:"ID",dataIndex:"id",key:"id",sorter:!0,sortDirections:["descend","ascend"]},{title:"NAME",dataIndex:"name",key:"name",scopedSlots:{filterDropdown:"filterDropdown",filterIcon:"filterIcon"}},{title:"FLAG FORMAT",dataIndex:"flag_format",key:"flag_format",ellipsis:!0},{title:"RANK",dataIndex:"rank",key:"rank",scopedSlots:{customRender:"rank"}},{title:"PUSH TO CLIENT",dataIndex:"push_to_client",key:"push_to_client",scopedSlots:{customRender:"switchRender"}},{title:"NOTICE",dataIndex:"notice",key:"notice",scopedSlots:{customRender:"switchRender"}},{title:"Action",key:"action",scopedSlots:{customRender:"action"}}],p={response_status_code:[{validator:function(e,t,a){return void 0===t||!isNaN(t)&&100<t&&t<600||/\${(query|body|header)\..+?}/.test(t)?a():a(new Error("please input legal response status code value"))},trigger:"blur"}]},h={name:"HttpRules",data:function(){return{store:i["store"],data:[],formVisible:!1,pagination:{current:1,showSizeChanger:!0,pageSize:i["store"].pageSize,onShowSizeChange:function(e,t){i["store"].pageSize=t}},filters:{},loading:!1,columns:f,form:{},rules:p,formReadOnly:!1,formAction:"",headerKeys:[1],headerSet:["Accept-Patch","Accept-Ranges","Age","Allow","Cache-Control","Connection","Content-Disposition","Content-Encoding","Content-Language","Content-Length","Content-Location","Content-Range","Content-Type","Date","Delta-Base","ETag","Expires","Last-Modified","Link","Location","Pragma","Proxy-Authenticate","Public-Key-Pins","Retry-After","Server","Set-Cookie","Strict-Transport-Security","Transfer-Encoding","Upgrade","Vary","Via","Warning","WWW-Authenticate","Content-Security-Policy","Refresh","X-Powered-By","X-Request-ID","X-UA-Compatible","X-XSS-Protection","Access-Control-Allow-Origin","Access-Control-Allow-Credentials","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Allow-Methods","Access-Control-Allow-Headers"],fullScreenTextarea:!1}},methods:{handleTableChange:function(e,t,a){var o=Object(n["a"])({},this.pagination);o.current=e.current,this.pagination=o,this.order="ascend"===a.order?"asc":"desc",this.fetch()},fetch:function(){var e=this,t=Object(n["a"])(Object(n["a"])({},this.filters),{},{page:this.pagination.current,pageSize:this.pagination.pageSize,order:this.order});this.loading=!0,Object(s["h"])(t).then((function(t){var a=t.data.result;e.data=a.data;var o=Object(n["a"])({},e.pagination);o.total=a.count,e.pagination=o,e.loading=!1})).catch((function(t){403!==t.response.status&&e.$message.error("Unknown error with status code: "+t.response.status)}))},clickSwitch:function(e,t){var a=this;e[t]=!e[t],Object(s["m"])(e).catch((function(e){a.$notification.error({message:"Edit failed",description:e.response.data.error,style:{width:"600px",marginLeft:"".concat(-265,"px")},duration:4})}))},addRule:function(){this.form={},this.showForm(u)},viewRule:function(e){this.form=e,this.showForm(c)},editRule:function(e){this.form=JSON.parse(JSON.stringify(e)),this.showForm(d)},deleteRule:function(e,t){var a=this;Object(s["c"])(e).then((function(){a.data.splice(t,1)})).catch((function(e){a.$notification.error({message:"Error",description:e.response.data.error,style:{width:"600px",marginLeft:"".concat(-265,"px")},duration:4})}))},showForm:function(e){for(var t in this.formAction=e,this.formReadOnly=e===c,this.formVisible=!0,this.form.response_headers)this.form["Header-"+this.headerKeys.length]=t,this.form["Value-"+this.headerKeys.length]=this.form.response_headers[t],this.addHeader();this.formReadOnly&&this.removeHeader(this.headerKeys.length)},closeDrawer:function(){this.formVisible=!1,this.headerKeys=[1]},addHeader:function(){this.headerKeys.push(this.headerKeys[this.headerKeys.length-1]+1)},removeHeader:function(e){this.headerKeys.length>1&&this.headerKeys.splice(this.headerKeys.indexOf(e),1)},filterOption:function(e,t){return t.componentOptions.children[0].text.toUpperCase().indexOf(e.toUpperCase())>=0},handleSubmit:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;var a={},o={};for(var r in e.form)if(0===r.indexOf("Header-")){var n=r.substr("Header-".length);e.form["Value-"+n]&&(o[e.form[r]]=e.form["Value-"+n])}else-1===r.indexOf("Value-")&&(a[r]=e.form[r]);a.response_headers=o,Object(s["m"])(a).then((function(){e.closeDrawer(),e.fetch({page:e.pagination.current}),e.$notification.info({message:"Success",style:{width:"600px",marginLeft:"".concat(-265,"px")},duration:2.5})})).catch((function(t){e.$notification.error({message:e.formAction+" failed",description:t.response.data.error,style:{width:"600px",marginLeft:"".concat(-265,"px")},duration:4})}))}))},handleCancel:function(){this.form={},this.closeDrawer()},fullScreenTextareaMinRows:function(){return document.body.clientHeight/window.getComputedStyle(document.body)["fontSize"].slice(0,-2)*.5}},mounted:function(){this.fetch({page:"1"})},components:{BasicRule:l["a"]}},m=h,y=(a("f003"),a("2877")),g=Object(y["a"])(m,o,r,!1,null,"b1cc51ba",null);t["default"]=g.exports},f003:function(e,t,a){"use strict";a("5fa3")}}]);